# 책임 할당하기

## 책임 주도 설계를 향해

### 데이터보다 행동을 먼저 결정하라

- 객체에게 중요한 것은 데이터가 아니라 외부에 제공하는 행동이다.
- 데이터는 객체가 책임을 수행하는 데 필요한 재료를 제공할 뿐이다.

### 협력이라는 문맥 안에서 책임을 결정하라

- 객체에게 할당된 책임의 품질은 협력에 적합한 정도로 결정된다.
- 책임은 객체의 입장이 아니라 협력에 적합하여야 한다.

### 책임 주도 설계

- 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임을 파악한다.
- 시스템 책임을 더 작은 책임으로 분할한다.
- 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당한다.
- 객체가 책임을 수행하는 도중 다른 객체의 도움이 필요한 경우 이를 책임질 적절한 객체 또는 역할을 찾는다.
- 해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력하게 한다.

## 책임 할당을 위한 GRASP 패턴

크레이그 라만이 패턴 형식으로 제안한 것

### 도메인 개념에서 출발하기

- 설계를 시작하기 전에 도메인에 대한 개략적인 모습을 그려보는 것이 유용하다.
- 유력한 후보는 바로 도메인 개념이다.

### 정보 전문가에게 책임을 할당하라

- 메시지를 전송할 객체는 무엇을 원하는가?
- 메시지를 수신할 적합한 객체는 누구인가?
- GRASP에서 **Information Expert(정보전문가)** 패턴이라고 부른다.

### 높은 응집도와 낮은 결합도

- 설계 중에서 한 가지를 선택해야 하는 경우 올바른 책임 할당을 위해 **Information Expert**패턴 이외에도 다른 책임 할당 패턴을 함께 고려해야 한다.
- 이때 고려해야 하는 것이 응집도와 결합도이며 제일 좋은 설계는 **Low Coupling(낮은 결합도)** 패턴과 **High Cohesion(높은 응집도)** 패턴이다.

### 창조자에게 객체 생성 책임을 할당하라

- **Creator(생성자)** 패턴
  - 객체 A를 생성시에 A에 대해 가장 잘 알고 있는 객체를 통해 생성하여라. 
  - 잘 알고 있는 객체란 포함, 참조, 기록, 사용, 초기 값을 갖고 있는 객체

## 구현을 통한 검증

### 타입 분리하기

- 하나의 클래스에서 순번 조건, 기간 조건이라는 독립적인 타입이 존재할 필요는 없다.
- 두 개의 클래스로 분리하자.

### 다형성을 통해 분리하기

- 영화는 할인 조건에 대해서 자세히 알 필요가 없다.
- 할인 조건에 집중하기 기간 할인 조건인지 순번 할인 조건인지 구분하지 말자.
- Polymorpohism 패턴
  - 객체의 타입에 따라 변하는 로직이 있다면 if문을 사용하지 말고 다형성을 사용하여라

### 변경으로 부터 보호하기

- 새로운 할인 조건이 추가된다면 어떻게 될까
- 캡슐화가 잘되어 있었다면 변하지 않을 것이다.
- Protected Variations 패턴
  - 변화가 예쌍되는 불안정된 지점들을 식별화하고 그 주위에 안정된 인터페이스를 형성하여라
  - 변하는 것봐 변하지 않는 것을 구분하는 것이 중요하다.

## 책임 주도 설계의 대안

- 빠르게 기능을 수행하는 코드를 작성한 후 코드 상의 책임을 올바른 위치에 넘기는 것이 하나의 방법이다.
- 코드를 수정한 후에 겉으로 드러나는 동작이 바뀌어서는 안된다.
- 이를 **리팩터링(Refactoring)** 이라고 부른다.



 

